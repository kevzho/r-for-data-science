---
title: "3-data-transformation"
output: html_document
---

### Importing Libraries
```{r}
library(nycflights13)
library(tidyverse)

#flights is a tibble, a special type of dataframe used by tidyverse to avoid some common gotchas. 
flights
```

can use `View(flights)`, `print(flights, width = Inf)`, or `glimpse()` to look at the tabular data

```{r}
glimpse(flights)
```
### dplyr basics
1. First argument is always a dataframe.
2. Subsequent arguments describe **which** columns to operate on using variable names (without quotes).
3. Output is always a new dataFrame. 

```{r}
flights |> #the "pipe" is |>, which takes the thing on its left and passes it along to the function on its right.
  filter(dest == "IAH") |>
  group_by(year, month, day) |>
  summarize(
    arr_delay = mean(arr_delay, na.rm = TRUE) #remove missing values
  )
```

### dplyr verbs (rows)

1. `filter(*condition*)` allows you to keep/filter rows based on values of the columns. For example, you could do this:
```{r}
flights |>
  filter(dep_delay > 120) #think of it as a "WHERE" clause in SQL, where you are able to input a condition

jan_feb <- flights |> #save result in variable to save the dataframe
  filter(month %in% c(1, 2)) #you can use %in% clause when combining "|" and "==". Keeps rows where variable equals one of the values in the vector describes. 
```

2. `arrange()` changes order of rows based off of the value of the columns. Within the parameter section, you can also specify `arrange(desc())` to order in a descending order. 
```{r}
flights |> #sorts by year, month, day, then departure time
  arrange(year, month, day, dep_time)
```

3. `distinct()` finds all unique rows in a dataset. Similar to the "DISTINCT" clause in SQL.
```{r}
flights |>
  distinct(origin, dest, .keep_all = TRUE) #specifies which rows to find unique.
#.keep_all preserves the other columns (without it, the dataframe would just be the 2 columns specified)
```

### Exercises: 

##### 1.
```{r}
#1.1
one_one <- flights |>
  filter(arr_delay >= 2)

#1.2
one_two <- flights |>
  filter(dest == "IAH" | dest == "HOU")

#1.3
one_three <- flights |> 
  filter(carrier %in% c("UA", "AA", "DL"))

#1.4
one_four <- flights |>
  filter(month %in% c(6, 7, 8))

#1.5
one_five <- flights |>
  filter(arr_delay > 2 & dep_delay == 0)

#1.6
one_six <- flights |>
  filter(dep_delay >= 1 & (sched_arr_time - sched_dep_time) - air_time > 30)

print("one")
head(one_one, n = 5)
print("two")
head(one_two, n = 5)
print("three")
head(one_three, n = 5)
print("four")
head(one_four, n = 5)
print("five")
head(one_five, n = 5)
print("six")
head(one_six, n = 5)

```

##### 2.

##### 3.

##### 4.

##### 5.

##### 6.

### dplyr verbs (columns)

1. `mutate()`
2. `select()`
3. `rename()`
4. `relocate()`
